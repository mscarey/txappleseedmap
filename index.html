<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Texas School Discipline Disparities</title>
		<script type="text/javascript" src="./js/d3.js"></script>
        <link rel="shortcut icon" href="favicon.ico" />
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <header class="masthead">
                <h1 class="masthead__logo"></h1>
                <div class="masthead__content">
                    <h1 class="masthead__title h2">Texas School Discipline Punishments by Race/Ethnicity<br>Pre-K through 12th Grade (2015-16)</h1>
                    <span class="masthead__disclaimer">Data Source: Texas Education Agency. Download the <a href="https://data.world/mcarey/tx-student-suspensions-2015">full dataset at data.world</a></span>
    
                <div class="masthead_right">
                    <div class="masthead_select">
                    <select id="dropdown">
                        <option value="OSS">Out of School Suspensions</option>
                        <option value="Expulsion">Expulsion Actions</option>
                        <option value="AltEdu">Alternative Placements</option>
                        <option value="ISS">In School Suspensions</option>
                    </select>
                    </div>
                    <div class="masthead_select student_characteristic_selector">
                    <select id="dropdown">
                        <option value="0">Black/African American Students</option>
                        <option value="1">Asian Students</option>
                        <option value="2">Latino Students</option>
                        <option value="3">Native American Students</option>
                        <option value="4">Special Education Students</option>
                        <option value="5">Students of two or More Races</option>
                        <option value="6">White Students</option>
                    </select>
                    </div>
                    <form class="masthead_search" role="search">
                    <div>
                        <input id="searchbox" type="text" placeholder="Search by district" class="form-control">
                    </div>
                    </form>
                </div>
                </div></header>
    	<script type="text/javascript">

            //Width and height
            var w = 800;
            var h = 600;

            //Default incident characteristics
            var demo = "Black/African-American Students";
            var action = "Out of School Suspensions";

            //Define map projection
            var projection = d3.geoAlbersUsa()
                                    .translate([w/2, 0])
                                    .scale([2000]);

            //Define path generator
            var path = d3.geoPath()
                                .projection(projection);
            
            //Define scale to sort data values into buckets of color
            var color = d3.scaleOrdinal(d3.schemeRdYlGn[11]);

            //Create SVG element
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);
            
            d3.json("./geojson/districts_with_default_data.geojson").then(function(json) {
                
                color.domain([0,10]);

                //Bind data and create one path per GeoJSON feature
                svg.selectAll("path")
                    .data(json.features)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("fill", function(d) {
                        //Get data value
                        var value = d.properties.disparity;
                        
                        if (value) {
                            //If value exists…
                            return color(value);
                        } else {
                            //If value is undefined…
                            return "#ccc";
                        }
                    })
                    .append("title")
                    .text(function(d) {
                        var actions = d.properties.groupActions;
                        
                        if (actions) {
                            
                            return "In " + d.properties.DISTNAME +
                            ", " + action + " were assigned " + 
                            d.properties.groupActions + " times to the population of " +
                            d.properties.groupPop + " " + demo + ", compared to " +
                            d.properties.allActions + " times for the overall population of " +
                            d.properties.allPop + " students.";
                        }

                        else { 
                            return "Data is not available for " +
                            action + " assigned to " + demo +
                            " in " + d.properties.DISTNAME}
                });
             
            });

        </script>
    </body>
</html>